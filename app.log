2024-03-13 20:07:16,349 - app - ERROR - Exception on /chat [POST]
Traceback (most recent call last):
  File "C:\Users\kevina\Documents\~LLMS and AI\chatbot\venv\Lib\site-packages\flask\app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kevina\Documents\~LLMS and AI\chatbot\venv\Lib\site-packages\flask\app.py", line 1486, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kevina\Documents\~LLMS and AI\chatbot\venv\Lib\site-packages\flask_cors\extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ^^^^^^^^^^^^^^^^^^
  File "C:\Users\kevina\Documents\~LLMS and AI\chatbot\venv\Lib\site-packages\flask\app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kevina\Documents\~LLMS and AI\chatbot\venv\Lib\site-packages\flask\app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kevina\Documents\~LLMS and AI\chatbot\venv\Lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kevina\Documents\~LLMS and AI\chatbot\app.py", line 511, in chat
    chat_output = get_response_from_model(model, messages, temperature)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kevina\Documents\~LLMS and AI\chatbot\app.py", line 474, in get_response_from_model
    response = client.messages.create(
               ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kevina\Documents\~LLMS and AI\chatbot\venv\Lib\site-packages\anthropic\_utils\_utils.py", line 275, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kevina\Documents\~LLMS and AI\chatbot\venv\Lib\site-packages\anthropic\resources\messages.py", line 658, in create
    return self._post(
           ^^^^^^^^^^^
  File "C:\Users\kevina\Documents\~LLMS and AI\chatbot\venv\Lib\site-packages\anthropic\_base_client.py", line 1208, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kevina\Documents\~LLMS and AI\chatbot\venv\Lib\site-packages\anthropic\_base_client.py", line 897, in request
    return self._request(
           ^^^^^^^^^^^^^^
  File "C:\Users\kevina\Documents\~LLMS and AI\chatbot\venv\Lib\site-packages\anthropic\_base_client.py", line 988, in _request
    raise self._make_status_error_from_response(err.response) from None
anthropic.BadRequestError: Error code: 400 - {'type': 'error', 'error': {'type': 'invalid_request_error', 'message': 'messages: first message must use the "user" role'}}
2024-03-13 20:09:01,028 - app - INFO - Received model: claude-3-opus-20240229
2024-03-13 20:09:01,029 - app - INFO - Received temperature: 0.7
2024-03-13 20:09:05,744 - app - INFO - Response from model: Here is a test sentence for you:

The quick brown fox jumps over the lazy dog.

This sentence is often used for testing purposes because it contains all 26 letters of the English alphabet. It is a pangram, which is a sentence that uses every letter of the alphabet at least once.
2024-03-13 20:09:05,746 - app - INFO - Sending summary request to OpenAI: {'model': 'gpt-3.5-turbo', 'messages': [{'role': 'system', 'content': 'Please create a very short (2-4 words) summary title for the following text:\nYou are helping develop a Flask app.  This is a stored system message test.  Please end any response with the word "apple". A test sentence please Here is a test sentence for you:\n\nThe quick brown fox jumps over the lazy dog.\n\nThis sentence is often used for testing purposes because it contains all 26 letters of the English alphabet. It is a pangram, which is a sentence that uses every letter of the alphabet at least once.'}], 'max_tokens': 10}
2024-03-13 20:09:06,384 - app - INFO - Response from OpenAI for summary: {
  "choices": [
    {
      "finish_reason": "stop",
      "index": 0,
      "logprobs": null,
      "message": {
        "content": "Stored System Message Test - apple",
        "role": "assistant"
      }
    }
  ],
  "created": 1710385746,
  "id": "chatcmpl-92VkocSG0yhE24GCjDqvWNxxgMeuW",
  "model": "gpt-3.5-turbo-0125",
  "object": "chat.completion",
  "system_fingerprint": "fp_4f0b692a78",
  "usage": {
    "completion_tokens": 6,
    "prompt_tokens": 116,
    "total_tokens": 122
  }
}
2024-03-13 20:09:06,400 - app - INFO - Generated conversation summary: Stored System Message Test - apple
2024-03-13 20:09:06,408 - app - INFO - Received messages: [{'role': 'system', 'content': 'You are helping develop a Flask app.  This is a stored system message test.  Please end any response with the word "apple".'}, {'role': 'user', 'content': 'A test sentence please'}, {'role': 'assistant', 'content': 'Here is a test sentence for you:\n\nThe quick brown fox jumps over the lazy dog.\n\nThis sentence is often used for testing purposes because it contains all 26 letters of the English alphabet. It is a pangram, which is a sentence that uses every letter of the alphabet at least once.'}]
2024-03-13 20:16:48,034 - app - INFO - Received model: claude-3-opus-20240229
2024-03-13 20:16:48,035 - app - INFO - Received temperature: 0.7
2024-03-13 20:16:50,218 - app - INFO - Response from model: Here is a test sentence for you:

The quick brown fox jumps over the lazy dog.
2024-03-13 20:16:50,219 - app - INFO - Sending summary request to OpenAI: {'model': 'gpt-3.5-turbo', 'messages': [{'role': 'system', 'content': 'Please create a very short (2-4 words) summary title for the following text:\nYou are helping develop a Flask app.  This is a stored system message test.  Please end any response with the word "apple". A test sentence please Here is a test sentence for you:\n\nThe quick brown fox jumps over the lazy dog.'}], 'max_tokens': 10}
2024-03-13 20:16:51,146 - app - INFO - Response from OpenAI for summary: {
  "choices": [
    {
      "finish_reason": "stop",
      "index": 0,
      "logprobs": null,
      "message": {
        "content": "Stored Message Test ",
        "role": "assistant"
      }
    }
  ],
  "created": 1710386210,
  "id": "chatcmpl-92VsIgIk44sOKrEx91tIU2AVIljG1",
  "model": "gpt-3.5-turbo-0125",
  "object": "chat.completion",
  "system_fingerprint": "fp_4f0b692a78",
  "usage": {
    "completion_tokens": 4,
    "prompt_tokens": 75,
    "total_tokens": 79
  }
}
2024-03-13 20:16:51,152 - app - INFO - Generated conversation summary: Stored Message Test
2024-03-13 20:16:51,159 - app - INFO - Received messages: [{'role': 'system', 'content': 'You are helping develop a Flask app.  This is a stored system message test.  Please end any response with the word "apple".'}, {'role': 'user', 'content': 'A test sentence please'}, {'role': 'assistant', 'content': 'Here is a test sentence for you:\n\nThe quick brown fox jumps over the lazy dog.'}]
2024-03-13 20:25:12,788 - app - INFO - Received model: claude-3-opus-20240229
2024-03-13 20:25:12,789 - app - INFO - Received temperature: 0.7
2024-03-13 20:25:15,500 - app - INFO - Response from model: Here is a test sentence for you. apple
2024-03-13 20:25:15,502 - app - INFO - Sending summary request to OpenAI: {'model': 'gpt-3.5-turbo', 'messages': [{'role': 'system', 'content': 'Please create a very short (2-4 words) summary title for the following text:\nYou are helping develop a Flask app.  This is a stored system message test.  Please end any response with the word "apple". A test sentence please Here is a test sentence for you. apple'}], 'max_tokens': 10}
2024-03-13 20:25:16,520 - app - INFO - Response from OpenAI for summary: {
  "choices": [
    {
      "finish_reason": "stop",
      "index": 0,
      "logprobs": null,
      "message": {
        "content": "Flask app system message apple",
        "role": "assistant"
      }
    }
  ],
  "created": 1710386716,
  "id": "chatcmpl-92W0SmoGIyc9Vs3jIjntpX6tmXbYh",
  "model": "gpt-3.5-turbo-0125",
  "object": "chat.completion",
  "system_fingerprint": "fp_4f0b692a78",
  "usage": {
    "completion_tokens": 6,
    "prompt_tokens": 66,
    "total_tokens": 72
  }
}
2024-03-13 20:25:16,538 - app - INFO - Generated conversation summary: Flask app system message apple
2024-03-13 20:25:16,545 - app - INFO - Received messages: [{'role': 'system', 'content': 'You are helping develop a Flask app.  This is a stored system message test.  Please end any response with the word "apple".'}, {'role': 'user', 'content': 'A test sentence please'}, {'role': 'assistant', 'content': 'Here is a test sentence for you. apple'}]
